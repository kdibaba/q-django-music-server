<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
	<head>
	    <title>{% block title %}Music{% endblock %}</title>
	    <link href='http://fonts.googleapis.com/css?family=Volkhov' rel='stylesheet' type='text/css'>
	    <link href='http://fonts.googleapis.com/css?family=Kelly+Slab' rel='stylesheet' type='text/css'>
	    <link rel="stylesheet" type="text/css" href="/static/css/base.css" />
	    <link rel="stylesheet" type="text/css" href="/static/css/music.css" />
	    <link type="text/css" href="/static/css/jplayer.blue.monday.css" rel="stylesheet" />
	    <script src="/static/javascript/lib/jquery.min.js" type="text/javascript" charset="utf-8"></script>
	    <script src="/static/javascript/lib/jquery.hoverIntent.minified.js" type="text/javascript" charset="utf-8"></script>
	    <script src="/static/javascript/lib/jquery.jplayer.min.js" type="text/javascript" charset="utf-8"></script>
	    <script src="/static/javascript/lib/jplayer.playlist.min.js" type="text/javascript" charset="utf-8"></script>
	    <script src="/static/javascript/lib/spin.min.js" type="text/javascript" charset="utf-8"></script>
	    <script src="/static/javascript/music.js" type="text/javascript" charset="utf-8"></script>
	    <script type="text/javascript">
	    $(document).ready(function(){

		    //HANDLE url changes
		    $(window).bind( 'hashchange', function(){handle_hash()});
		    handle_hash();

		    //HANDLE jPlayer size
			//var new_width = $(window).width() - 316
			//$('.jp-mute').css('margin-left', new_width+'px')
		    //$(window).resize(function() {
			//  var new_width = $(window).width() - 316  
			//  $('.jp-mute').css('margin-left', new_width+'px')
			//});
			
			$("#menu_albums").hoverIntent({
				over: show_menu_albums,
				timeout: 500,
				out: hide_menu_albums
			});
			
			$("#menu_artists").hoverIntent({
				over: show_menu_artists,
				timeout: 500,
				out: hide_menu_artists
			});
			
			$("#menu_add_music").hoverIntent({
				over: show_menu_add,
				timeout: 500,
				out: hide_menu_add
			});
			
			$("#menu_search").hoverIntent({
				over: show_menu_search,
				timeout: 500,
				out: hide_menu_search
			});

			function show_menu_albums(){$('.nav_button_albums').slideDown();}
			function hide_menu_albums(){ $('.nav_button_albums').slideUp()}
			function show_menu_artists(){$('.nav_button_artists').slideDown()}
			function hide_menu_artists(){$('.nav_button_artists').slideUp()}
			function show_menu_add(){$('.nav_button_add').slideDown()}
			function hide_menu_add(){$('.nav_button_add').slideUp()}
			function show_menu_search(){$('.nav_button_search').slideDown()}
			function hide_menu_search(){$('.nav_button_search').slideUp()}

		    $("#searchBox").keyup(function(){
			    if (event.keyCode == 13){
			    	location.href='/#/search/'+$("#searchBox").val();
			    }
		        });

			   
		    //$('.nav_button_add').hover( function(){$('.nav_button_add').show(); }, function(){$('.nav_button_add').hide(); });
		    //$('.nav_button_artists').hover( function(){$('.nav_button_artists').show(); }, function(){$('.nav_button_artists').hide(); });
		    //$('.nav_button_albums').hover( function(){$('.nav_button_albums').show(); }, function(){$('.nav_button_albums').hide(); });
		    //$('.nav_button_search').hover( function(){$('.nav_button_search').show(); }, function(){$('.nav_button_search').hide(); });
			  
	    	PLAYLIST = new jPlayerPlaylist({
	    		jPlayer: "#jquery_jplayer_1",
	    		cssSelectorAncestor: "#jp_container_1"
	    	},  [], {
	    		swfPath: "/static/javascript/",
	    		supplied: "oga, mp3",
	    		solution: "flash, html"
	    	});
	    	$(document.documentElement).keyup(function (event) {
	    		if (event.keyCode == 32) {
		    		if(NOW_PLAYING){
		    		    PLAYLIST.pause();
		    			NOW_PLAYING = false
		    		}
		    		else{
			    		PLAYLIST.play();
			    		NOW_PLAYING = true
	    		  	}
	    		}
	    		else if (event.keyCode == 78) {
		    		if(PLAYLIST){
		    		    PLAYLIST.next();
		    		}
	    		}
	    		});
	    });
	    </script>
	    {% block head %}{% endblock %}
	    {% block extrahead %}{% endblock %}
	    
	</head>
	<body>
		<div id="site_header_wrapper">
			<div id="site_header">
				<qtext id="site_title">Q Music</qtext>
		   		{% if request.user.is_authenticated  %}
		   		<div id="logout">
		   			<text>Logged In : {{request.user.username.upper}}</text>
		   			<a href="/logout">Logout</a>
		   		</div>
		    	{% endif %}</text>
		    </div>
		</div>
		<div id="site_body">
			<div id="navigation">
				<div class=nav_button>
					<div id="menu_home" onclick="location.href='/'" ><p>Home</p></div>
					<div ondblclick="location.href='#/artists/all'" id="menu_artists">
						<p>Artists</p>
						<div class="nav_button_artists" style="display:none;">
							{% for letter in letter_list %}
								<div class="sub_menu_link" onclick="location.href='/#/artists/{{letter}}'">{{letter}}</div>
							{% endfor %}
						</div>
						</div>
					<div ondblclick="location.href='#/albums/all'" id="menu_albums">
						<p>Albums</p>
						<div class="nav_button_albums" style="display:none;">
							{% for letter in letter_list %}
								<div class="sub_menu_link" onclick="location.href='/#/albums/{{letter}}'">{{letter}}</div>
							{% endfor %}
						</div>
						</div>
					<div id="menu_search">
						<p>Search</p>
						<div class="nav_button_search" style="display:none;">
							<input class="" type="text" id="searchBox" placeholder="Search My Library">
						</div>
					</div>
					<div id="menu_add_music">
						<p>Add Music</p>
						<div class="nav_button_add" style="display:none;">
							{% if request.user.is_superuser  %}<div class="sub_menu_link" onclick="add_music('add')">Add New</div>{% endif %}
							{% if request.user.is_superuser  %}<div class="sub_menu_link" onclick="add_music('rebuild')">Rebuild DB</div>{% endif %}
							<div class="sub_menu_link" onclick="location.href='/add_music/upload/'">Upload</div>
						</div>
						</div>
				</div>
			</div>
			{% block content %}
			<div id="status_message" style="display:none;"></div>
			<div id=content>
				<center><text id="welcome">Q</text></center>
			</div>
			{% endblock %}
			</div>
			<div id="footer_wrapper">
				<div id="footer">
				</div>
			</div>
	</body>
</html>